<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏–≥–∞ —Å—Ç–∞–≤–æ–∫ –Ω–∞ –Ω–∞—Å—Ç–æ–ª—å–Ω—ã–π —Ç–µ–Ω–Ω–∏—Å</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #7c3aed;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f9fafb;
            --gray: #6b7280;
            --gray-light: #e5e7eb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f8fafc;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .navbar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.3s;
            padding: 0.5rem;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .nav-links a.active {
            color: var(--primary);
            font-weight: 600;
        }

        .btn-login, .btn-admin {
            background: var(--primary);
            color: white !important;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            white-space: nowrap;
        }

        .btn-admin {
            background: var(--danger);
        }

        /* –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--dark);
            cursor: pointer;
        }

        .mobile-menu {
            display: none;
            position: fixed;
            top: 70px;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 999;
            padding: 1rem;
        }

        .mobile-menu.active {
            display: block;
        }

        .mobile-menu a {
            display: block;
            padding: 1rem;
            text-decoration: none;
            color: var(--dark);
            border-bottom: 1px solid var(--gray-light);
        }

        .mobile-menu a:last-child {
            border-bottom: none;
        }

        /* –ì–µ—Ä–æ–π —Å–µ–∫—Ü–∏—è */
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 1rem;
            text-align: center;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            font-weight: 800;
        }

        .hero-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 2rem;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255,255,255,0.1);
            border-radius: 1rem;
            min-width: 150px;
        }

        .stat i {
            font-size: 2rem;
            opacity: 0.8;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            display: block;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-primary, .btn-secondary {
            padding: 0.8rem 1.5rem;
            border-radius: 0.5rem;
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .btn-primary {
            background: white;
            color: var(--primary);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }

        /* –ü—Ä–∞–≤–∏–ª–∞ */
        .rules-banner {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 4px solid var(--warning);
            margin: 2rem auto;
            padding: 1.5rem;
            border-radius: 0.5rem;
            max-width: 1200px;
        }

        .banner-content {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .banner-icon {
            font-size: 1.5rem;
            color: var(--warning);
            flex-shrink: 0;
            margin-top: 0.25rem;
        }

        /* –°–µ–∫—Ü–∏–∏ */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1.5rem 0 0;
        }

        .section-header h2 {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* –ú–∞–≥–∞–∑–∏–Ω */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            padding: 1rem 0 2rem;
        }

        .shop-item {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        .shop-item.featured {
            border: 2px solid var(--primary);
            position: relative;
        }

        .shop-item.featured::before {
            content: 'üî• –ü–û–ü–£–õ–Ø–†–ù–û';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 2rem;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .item-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .item-icon.rating {
            background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%);
            color: white;
        }

        .item-icon.skip {
            background: linear-gradient(135deg, #10b981 0%, #065f46 100%);
            color: white;
        }

        .item-icon.double {
            background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%);
            color: white;
        }

        .item-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--warning);
            margin: 0.5rem 0;
        }

        .item-price i {
            margin-right: 0.25rem;
        }

        .item-description {
            color: var(--gray);
            margin-bottom: 1rem;
            font-size: 0.9rem;
            flex-grow: 1;
        }

        /* –ú–∞—Ç—á–∏ */
        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            padding: 1rem 0 2rem;
        }

        @media (max-width: 640px) {
            .matches-grid, .shop-grid {
                grid-template-columns: 1fr;
            }
        }

        .match-card {
            background: white;
            border-radius: 1rem;
            padding: 1.25rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .match-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .match-status {
            padding: 0.25rem 0.75rem;
            border-radius: 2rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-live {
            background: #fef3c7;
            color: #92400e;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .match-players {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            gap: 0.5rem;
        }

        .player {
            text-align: center;
            flex: 1;
        }

        .player-avatar-img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto 0.5rem;
            object-fit: cover;
            border: 3px solid var(--primary);
        }

        .player-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            margin: 0 auto 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            font-weight: bold;
        }

        .vs {
            font-weight: bold;
            color: var(--gray);
            margin: 0 0.5rem;
            font-size: 0.9rem;
        }

        .player-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
        }

        .player-rating {
            color: var(--gray);
            font-size: 0.8rem;
            background: var(--gray-light);
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            display: inline-block;
        }

        .match-odds {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .odds-btn {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid var(--gray-light);
            border-radius: 0.5rem;
            background: none;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .odds-btn:hover {
            border-color: var(--primary);
            background: #eff6ff;
        }

        .odds-btn.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .odds-btn.selected .odds-value {
            color: white;
        }

        .odds-value {
            display: block;
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--primary);
            margin-top: 0.25rem;
        }

        /* –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ */
        .leaderboard-table {
            background: white;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin: 1rem 0 2rem;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        th {
            background: #f9fafb;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--gray);
            border-bottom: 2px solid var(--gray-light);
        }

        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--gray-light);
        }

        tr:hover {
            background: #f9fafb;
        }

        .player-rank {
            font-weight: bold;
            color: var(--primary);
            text-align: center;
        }

        .player-avatar-small {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 10px;
            vertical-align: middle;
            border: 2px solid var(--primary);
        }

        /* –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å */
        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            padding: 2rem 0;
        }

        .step {
            text-align: center;
            padding: 1.5rem;
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .step-number {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin: 0 auto 1rem;
        }

        .step-icon {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .step h3 {
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        /* –§—É—Ç–µ—Ä */
        .footer {
            background: var(--dark);
            color: white;
            padding: 2rem 0 1rem;
            margin-top: 3rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h3, .footer-section h4 {
            margin-bottom: 1rem;
            color: white;
            font-size: 1.1rem;
        }

        .footer-section a {
            color: #d1d5db;
            text-decoration: none;
            display: block;
            margin-bottom: 0.5rem;
            transition: color 0.3s;
        }

        .footer-section a:hover {
            color: white;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid #374151;
            color: #9ca3af;
            font-size: 0.75rem;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            padding: 1rem;
        }

        .modal-content {
            background: white;
            margin: 10% auto;
            padding: 1.5rem;
            border-radius: 1rem;
            max-width: 500px;
            width: 100%;
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            right: 1rem;
            top: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
            background: none;
            border: none;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--gray-light);
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .bet-btn {
            padding: 0.75rem 1.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s, transform 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .bet-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .bet-btn.danger {
            background: var(--danger);
        }

        .bet-btn.danger:hover {
            background: #dc2626;
        }

        .bet-btn.success {
            background: var(--success);
        }

        .bet-btn.success:hover {
            background: #059669;
        }

        .bet-btn.warning {
            background: var(--warning);
        }

        .bet-btn.warning:hover {
            background: #d97706;
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—à–∏–±–∫–∏ */
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--gray);
        }

        .error-message {
            background: #fee2e2;
            color: #991b1b;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }

        .success-message {
            background: #d1fae5;
            color: #065f46;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            color: white;
            font-weight: 500;
            z-index: 1002;
            animation: slideIn 0.3s ease;
            max-width: 300px;
            word-wrap: break-word;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.success { background: var(--success); }
        .notification.error { background: var(--danger); }
        .notification.info { background: var(--primary); }

        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 1002;
            padding: 1rem;
            overflow-y: auto;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .admin-section {
            background: white;
            border-radius: 1rem;
            padding: 1.25rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .admin-section h3 {
            margin-bottom: 1rem;
            color: var(--dark);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .player-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--gray-light);
            border-radius: 0.5rem;
            padding: 0.5rem;
        }

        .player-item {
            padding: 0.75rem;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .player-item:last-child {
            border-bottom: none;
        }

        .player-info {
            flex: 1;
        }

        .player-actions {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            padding: 0.25rem 0.5rem;
            border: none;
            border-radius: 0.25rem;
            color: white;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .action-btn.add-tokens {
            background: var(--success);
        }

        .action-btn.delete {
            background: var(--danger);
        }

        .action-btn.small {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }

        /* –ü–æ–∫—É–ø–∫–∏ –∏–≥—Ä–æ–∫–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ */
        .player-purchases {
            background: #f8fafc;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.85rem;
        }

        .purchase-item {
            display: flex;
            justify-content: space-between;
            padding: 0.25rem 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .purchase-item:last-child {
            border-bottom: none;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .hero h1 {
                font-size: 1.75rem;
            }
            
            .hero-stats {
                gap: 1rem;
            }
            
            .stat {
                min-width: 120px;
                padding: 0.75rem;
            }
            
            .stat i {
                font-size: 1.5rem;
            }
            
            .stat-number {
                font-size: 1.5rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .steps-grid, .shop-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                margin: 5% auto;
                padding: 1rem;
            }
            
            .player-avatar-img, .player-avatar {
                width: 50px;
                height: 50px;
            }
            
            table {
                font-size: 0.9rem;
            }
            
            th, td {
                padding: 0.5rem;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 1.5rem;
            }
            
            .hero-subtitle {
                font-size: 1rem;
            }
            
            .stat {
                min-width: 100%;
                justify-content: center;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn-primary, .btn-secondary {
                width: 100%;
                justify-content: center;
            }
            
            .match-card, .shop-item {
                padding: 1rem;
            }
            
            .vs {
                font-size: 0.8rem;
            }
            
            .player-name {
                font-size: 0.8rem;
            }
            
            .player-rating {
                font-size: 0.7rem;
                padding: 0.15rem 0.35rem;
            }
        }
    </style>
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-table-tennis-paddle-ball"></i>
                <span>–¢–µ–Ω–Ω–∏—Å–Ω–∞—è –õ–∏–≥–∞</span>
            </div>
            
            <div class="nav-links">
                <a href="#" class="active"><i class="fas fa-home"></i> –ì–ª–∞–≤–Ω–∞—è</a>
                <a href="#matches"><i class="fas fa-trophy"></i> –ú–∞—Ç—á–∏</a>
                <a href="#shop"><i class="fas fa-store"></i> –ú–∞–≥–∞–∑–∏–Ω</a>
                <a href="#rules"><i class="fas fa-book"></i> –ü—Ä–∞–≤–∏–ª–∞</a>
                <a href="#login" class="btn-login" id="loginBtn"><i class="fas fa-user"></i> <span id="loginText">–í–æ–π—Ç–∏</span></a>
                <a href="#admin" class="btn-admin" id="adminBtn"><i class="fas fa-cog"></i> –ê–¥–º–∏–Ω</a>
            </div>
            
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
    <div class="mobile-menu" id="mobileMenu">
        <a href="#" class="active"><i class="fas fa-home"></i> –ì–ª–∞–≤–Ω–∞—è</a>
        <a href="#matches"><i class="fas fa-trophy"></i> –ú–∞—Ç—á–∏</a>
        <a href="#shop"><i class="fas fa-store"></i> –ú–∞–≥–∞–∑–∏–Ω</a>
        <a href="#rules"><i class="fas fa-book"></i> –ü—Ä–∞–≤–∏–ª–∞</a>
        <a href="#login" id="mobileLoginBtn"><i class="fas fa-user"></i> <span id="mobileLoginText">–í–æ–π—Ç–∏</span></a>
        <a href="#admin" id="mobileAdminBtn"><i class="fas fa-cog"></i> –ê–¥–º–∏–Ω</a>
    </div>

    <!-- –ì–µ—Ä–æ–π —Å–µ–∫—Ü–∏—è -->
    <section class="hero">
        <div class="hero-content">
            <h1>–õ–∏–≥–∞ —Å—Ç–∞–≤–æ–∫ –Ω–∞ –Ω–∞—Å—Ç–æ–ª—å–Ω—ã–π —Ç–µ–Ω–Ω–∏—Å</h1>
            <p class="hero-subtitle">–°–æ—Ä–µ–≤–Ω—É–π—Å—è, –¥–µ–ª–∞–π —Å—Ç–∞–≤–∫–∏, –ø–æ–±–µ–∂–¥–∞–π! –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –∂–µ—Ç–æ–Ω—ã –∑–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</p>
            
            <div class="hero-stats">
                <div class="stat">
                    <i class="fas fa-users"></i>
                    <div>
                        <span class="stat-number" id="total-players">0</span>
                        <span class="stat-label">–ò–≥—Ä–æ–∫–æ–≤ –≤ –ª–∏–≥–µ</span>
                    </div>
                </div>
                <div class="stat">
                    <i class="fas fa-trophy"></i>
                    <div>
                        <span class="stat-number" id="live-matches">0</span>
                        <span class="stat-label">–ú–∞—Ç—á–µ–π LIVE</span>
                    </div>
                </div>
                <div class="stat">
                    <i class="fas fa-coins"></i>
                    <div>
                        <span class="stat-number" id="total-bets">0</span>
                        <span class="stat-label">–ñ–µ—Ç–æ–Ω–æ–≤ –≤ –∏–≥—Ä–µ</span>
                    </div>
                </div>
            </div>
            
            <div class="hero-buttons">
                <a href="#matches" class="btn-primary">
                    <i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫–∏
                </a>
                <a href="#rules" class="btn-secondary">
                    <i class="fas fa-info-circle"></i> –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?
                </a>
            </div>
        </div>
    </section>

    <!-- –ü—Ä–∞–≤–∏–ª–∞ -->
    <section id="rules">
        <div class="container">
            <div class="rules-banner">
                <div class="banner-content">
                    <i class="fas fa-exclamation-triangle banner-icon"></i>
                    <div>
                        <h3>–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <p>–î–∞–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –≤–∞–ª—é—Ç—É (–∂–µ—Ç–æ–Ω—ã –ª–∏–≥–∏), –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –∏–º–µ–µ—Ç –¥–µ–Ω–µ–∂–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–º–µ–Ω–µ–Ω–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏. –í—Å–µ —Å—Ç–∞–≤–∫–∏ —Å–æ–≤–µ—Ä—à–∞—é—Ç—Å—è –≤ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- –ú–∞—Ç—á–∏ -->
    <section id="matches">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-broadcast-tower"></i> –ú–∞—Ç—á–∏ LIVE</h2>
                <button onclick="forceReloadMatches()" class="bet-btn small" style="padding: 0.5rem 1rem; font-size: 0.8rem;">
                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            <div class="matches-grid" id="live-matches-grid">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ç—á–µ–π...
                </div>
            </div>
        </div>
    </section>

    <!-- –ú–∞–≥–∞–∑–∏–Ω -->
    <section id="shop">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-store"></i> –ú–∞–≥–∞–∑–∏–Ω –∂–µ—Ç–æ–Ω–æ–≤</h2>
                <small>–ü–æ–∫—É–ø–∞–π—Ç–µ —É–ª—É—á—à–µ–Ω–∏—è –∏ –±–æ–Ω—É—Å—ã –∑–∞ –∂–µ—Ç–æ–Ω—ã</small>
            </div>
            <div class="shop-grid" id="shop-grid">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞...
                </div>
            </div>
        </div>
    </section>

    <!-- –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ -->
    <section class="leaderboard">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-crown"></i> –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤</h2>
                <button onclick="forceReloadLeaderboard()" class="bet-btn small" style="padding: 0.5rem 1rem; font-size: 0.8rem;">
                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            <div class="leaderboard-table">
                <table>
                    <thead>
                        <tr>
                            <th width="50">#</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–†–µ–π—Ç–∏–Ω–≥</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥—ã</th>
                            <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body">
                        <tr>
                            <td colspan="6" class="loading">
                                <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å -->
    <section class="how-to-play">
        <div class="container">
            <h2 class="section-title" style="text-align: center; margin-bottom: 2rem; font-size: 1.8rem;">–ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å?</h2>
            <div class="steps-grid">
                <div class="step">
                    <div class="step-number">1</div>
                    <i class="fas fa-user-plus step-icon"></i>
                    <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
                    <p>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –¥–ª—è –≤–∞—Å –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –∫–∞–ø–∏—Ç–∞–ª–æ–º</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <i class="fas fa-coins step-icon"></i>
                    <h3>–ü–æ–ª—É—á–∞–π—Ç–µ –∂–µ—Ç–æ–Ω—ã</h3>
                    <p>–£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ —Ç—É—Ä–Ω–∏—Ä–∞—Ö –∏ –º–∞—Ç—á–∞—Ö, –ø–æ–ª—É—á–∞–π—Ç–µ –∂–µ—Ç–æ–Ω—ã –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <i class="fas fa-hand-holding-usd step-icon"></i>
                    <h3>–î–µ–ª–∞–π—Ç–µ —Å—Ç–∞–≤–∫–∏</h3>
                    <p>–°—Ç–∞–≤—å—Ç–µ –¥–æ 50% –æ—Ç –±–∞–ª–∞–Ω—Å–∞ –Ω–∞ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –º–∞—Ç—á–∏</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <i class="fas fa-gift step-icon"></i>
                    <h3>–¢—Ä–∞—Ç—å—Ç–µ –≤—ã–∏–≥—Ä—ã—à</h3>
                    <p>–ü–æ–∫—É–ø–∞–π—Ç–µ –±–æ–Ω—É—Å—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ: —Ä–µ–π—Ç–∏–Ω–≥, –æ—Ç–º–µ–Ω–∞ —à—Ç—Ä–∞—Ñ–æ–≤ –∏ –¥—Ä.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3><i class="fas fa-table-tennis-paddle-ball"></i> –¢–µ–Ω–Ω–∏—Å–Ω–∞—è –õ–∏–≥–∞</h3>
                    <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å—Ç–∞–≤–æ–∫ –Ω–∞ –Ω–∞—Å—Ç–æ–ª—å–Ω—ã–π —Ç–µ–Ω–Ω–∏—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç—ã</p>
                </div>
                <div class="footer-section">
                    <h4>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h4>
                    <a href="#">–ì–ª–∞–≤–Ω–∞—è</a>
                    <a href="#matches">–ú–∞—Ç—á–∏</a>
                    <a href="#shop">–ú–∞–≥–∞–∑–∏–Ω</a>
                    <a href="#rules">–ü—Ä–∞–≤–∏–ª–∞</a>
                </div>
                <div class="footer-section">
                    <h4>–ê–∫–∫–∞—É–Ω—Ç</h4>
                    <a href="#login" onclick="openModal('loginModal')">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
                    <a href="#admin" onclick="openModal('adminModal')">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</a>
                </div>
                <div class="footer-section">
                    <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                    <p>–¢–æ–ª—å–∫–æ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ª–∏–≥–∏</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2024 –õ–∏–≥–∞ —Å—Ç–∞–≤–æ–∫ –Ω–∞ –Ω–∞—Å—Ç–æ–ª—å–Ω—ã–π —Ç–µ–Ω–Ω–∏—Å. –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –≤–∞–ª—é—Ç–∞, –Ω–µ –∏–º–µ—é—â–∞—è –¥–µ–Ω–µ–∂–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏.</p>
            </div>
        </div>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('loginModal')">&times;</button>
            <h2><i class="fas fa-user"></i> –í—Ö–æ–¥ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>–õ–æ–≥–∏–Ω:</label>
                    <input type="text" id="loginUsername" required>
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="bet-btn" style="width: 100%; margin-top: 1rem;">
                    <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏
                </button>
            </form>
        </div>
    </div>

    <div id="adminModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('adminModal')">&times;</button>
            <h2><i class="fas fa-cog"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</label>
                <input type="password" id="adminPassword">
            </div>
            <button onclick="enterAdminPanel()" class="bet-btn" style="width: 100%; margin-top: 1rem;">
                <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏
            </button>
        </div>
    </div>

    <div id="playerModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('playerModal')">&times;</button>
            <h2><i class="fas fa-user-circle"></i> –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
            <div id="playerInfo"></div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Supabase
        const SUPABASE_URL = 'https://bqycjfcjtdawyrysgrbw.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxeWNqZmNqdGRhd3lyeXNncmJ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2MDE5NzAsImV4cCI6MjA4MjE3Nzk3MH0.LEOUMFAd1cz_1e4uawJcaZLPCMqAQHEWM52Oy7fDjsE';

        let db;
        let currentUser = null;
        let isAdmin = false;
        let allPlayers = [];
        let playerCabinets = [];
        let allMatches = [];
        let playerPurchases = [];
        let shopItems = [];
        
        // –•—Ä–∞–Ω–∏–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ç—á–∞
        let selectedBets = {};
        
        // –§–ª–∞–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏
        let isDataLoaded = false;
        let loadingAttempts = 0;
        const MAX_LOADING_ATTEMPTS = 3;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            db = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            
            setupEventListeners();
            loadDataWithRetry();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    updateNavForUser();
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', e);
                    localStorage.removeItem('currentUser');
                }
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ 1 —Å–µ–∫—É–Ω–¥—É –¥–ª—è –ª—É—á—à–µ–≥–æ UX
            setTimeout(() => {
                if (!isDataLoaded && loadingAttempts < MAX_LOADING_ATTEMPTS) {
                    console.log('–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞...');
                    loadDataWithRetry();
                }
            }, 1000);
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
        async function loadDataWithRetry() {
            loadingAttempts++;
            console.log(`–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö #${loadingAttempts}`);
            
            try {
                await loadData();
                isDataLoaded = true;
                console.log('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            } catch (error) {
                console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ø—ã—Ç–∫–∞ ${loadingAttempts}):`, error);
                
                if (loadingAttempts < MAX_LOADING_ATTEMPTS) {
                    // –ñ–¥–µ–º –∏ –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞
                    setTimeout(() => {
                        loadDataWithRetry();
                    }, 1000 * loadingAttempts);
                } else {
                    showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.', 'error');
                }
            }
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            console.log('–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π...');
            
            // –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            
            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function() {
                    mobileMenu.classList.toggle('active');
                });
                
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å—Å—ã–ª–∫—É
                const mobileLinks = mobileMenu.querySelectorAll('a');
                mobileLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        mobileMenu.classList.remove('active');
                    });
                });
            }
            
            // –ö–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞
            const loginBtn = document.getElementById('loginBtn');
            const mobileLoginBtn = document.getElementById('mobileLoginBtn');
            
            if (loginBtn) {
                loginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (currentUser) {
                        showPlayerInfo();
                    } else {
                        openModal('loginModal');
                    }
                });
            }
            
            if (mobileLoginBtn) {
                mobileLoginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (currentUser) {
                        showPlayerInfo();
                    } else {
                        openModal('loginModal');
                    }
                });
            }
            
            // –ö–Ω–æ–ø–∫–∏ –∞–¥–º–∏–Ω–∞
            const adminBtn = document.getElementById('adminBtn');
            const mobileAdminBtn = document.getElementById('mobileAdminBtn');
            
            if (adminBtn) {
                adminBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    openModal('adminModal');
                });
            }
            
            if (mobileAdminBtn) {
                mobileAdminBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    openModal('adminModal');
                });
            }
            
            // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    loginUser();
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            });
            
            // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href');
                    if (targetId && targetId !== '#') {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            e.preventDefault();
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                });
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        async function loadData() {
            try {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
                await loadPlayersData();
                await loadMatchesData();
                await loadPurchasesData();
                await loadShopItems();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                await updateStats();
                await loadLiveMatches();
                await loadLeaderboard();
                
                console.log('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                console.log('–ò–≥—Ä–æ–∫–æ–≤:', allPlayers.length);
                console.log('–ú–∞—Ç—á–µ–π:', allMatches.length);
                console.log('–ö–∞–±–∏–Ω–µ—Ç–æ–≤:', playerCabinets.length);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ' + error.message, 'error');
                throw error;
            }
        }

        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ç—á–µ–π
        async function forceReloadMatches() {
            try {
                showNotification('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–µ–π...', 'info');
                
                // –û—á–∏—â–∞–µ–º –∫—ç—à Supabase
                allMatches = [];
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–Ω–æ–≤–æ
                await loadMatchesData();
                loadLiveMatches();
                
                showNotification('–ú–∞—Ç—á–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!', 'success');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞—Ç—á–µ–π:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + error.message, 'error');
            }
        }

        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤
        async function forceReloadLeaderboard() {
            try {
                showNotification('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤...', 'info');
                
                // –û—á–∏—â–∞–µ–º –∫—ç—à
                allPlayers = [];
                playerCabinets = [];
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–Ω–æ–≤–æ
                await loadPlayersData();
                loadLeaderboard();
                updateStats();
                
                showNotification('–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + error.message, 'error');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –° –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ú –û–ë–ù–û–í–õ–ï–ù–ò–ï–ú
        async function loadPlayersData() {
            try {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤...');
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ –∫—ç—à–∞
                const timestamp = Date.now();
                const [playersResponse, cabinetsResponse] = await Promise.all([
                    db.from('players')
                      .select('*')
                      .order('rating', { ascending: false })
                      .limit(1000), // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ª–∏–º–∏—Ç
                    db.from('player_cabinets')
                      .select('*')
                      .limit(1000)
                ]);
                
                if (playersResponse.error) throw playersResponse.error;
                if (cabinetsResponse.error) throw cabinetsResponse.error;
                
                allPlayers = playersResponse.data || [];
                playerCabinets = cabinetsResponse.data || [];
                
                console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–≥—Ä–æ–∫–æ–≤: ${allPlayers.length}, –∫–∞–±–∏–Ω–µ—Ç–æ–≤: ${playerCabinets.length}`);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ
                if (allPlayers.length === 0) {
                    console.warn('‚ö†Ô∏è –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∏–≥—Ä–æ–∫–∞—Ö!');
                    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
                    createTestPlayersIfNeeded();
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä–æ–∫–æ–≤:', error);
                // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                createTestPlayers();
                throw error;
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö
        function createTestPlayers() {
            console.log('–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤...');
            allPlayers = [
                { name: '–ò–≥—Ä–æ–∫ 1', rating: 1500, matches: 10, wins: 6, avatar: '' },
                { name: '–ò–≥—Ä–æ–∫ 2', rating: 1450, matches: 8, wins: 4, avatar: '' },
                { name: '–ò–≥—Ä–æ–∫ 3', rating: 1400, matches: 12, wins: 7, avatar: '' }
            ];
            
            playerCabinets = [
                { player_name: '–ò–≥—Ä–æ–∫ 1', tokens: 100 },
                { player_name: '–ò–≥—Ä–æ–∫ 2', tokens: 150 },
                { player_name: '–ò–≥—Ä–æ–∫ 3', tokens: 80 }
            ];
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ –µ—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞—è
        async function createTestPlayersIfNeeded() {
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤–æ–æ–±—â–µ –∫–∞–∫–∏–µ-—Ç–æ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
                const testQuery = await db.from('players').select('count').limit(1);
                
                if (testQuery.data && testQuery.data.length === 0) {
                    console.log('–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞, —Å–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ...');
                    
                    // –¢–µ—Å—Ç–æ–≤—ã–µ –∏–≥—Ä–æ–∫–∏
                    const testPlayers = [
                        { name: '–ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤', rating: 1550, matches: 15, wins: 9, avatar: '' },
                        { name: '–î–º–∏—Ç—Ä–∏–π –ü–µ—Ç—Ä–æ–≤', rating: 1480, matches: 12, wins: 7, avatar: '' },
                        { name: '–°–µ—Ä–≥–µ–π –°–∏–¥–æ—Ä–æ–≤', rating: 1420, matches: 10, wins: 5, avatar: '' }
                    ];
                    
                    // –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã
                    const testCabinets = [
                        { player_name: '–ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤', login: 'alex', password: '123', tokens: 200 },
                        { player_name: '–î–º–∏—Ç—Ä–∏–π –ü–µ—Ç—Ä–æ–≤', login: 'dima', password: '123', tokens: 150 },
                        { player_name: '–°–µ—Ä–≥–µ–π –°–∏–¥–æ—Ä–æ–≤', login: 'sergey', password: '123', tokens: 100 }
                    ];
                    
                    allPlayers = testPlayers;
                    playerCabinets = testCabinets;
                    
                    showNotification('–ó–∞–≥—Ä—É–∂–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ', 'info');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–∫—É–ø–æ–∫
        async function loadPurchasesData() {
            try {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫...');
                const { data, error } = await db
                    .from('player_purchases')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(1000);
                
                if (error) {
                    console.log('–¢–∞–±–ª–∏—Ü–∞ –ø–æ–∫—É–ø–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–æ–∫—É–ø–∫–µ');
                    playerPurchases = [];
                } else {
                    playerPurchases = data || [];
                    console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–æ–∫—É–ø–æ–∫: ${playerPurchases.length}`);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∫—É–ø–æ–∫:', error);
                playerPurchases = [];
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞
        function loadShopItems() {
            shopItems = [
                {
                    id: 'buy_rating_10',
                    name: '–ö—É–ø–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥',
                    description: '–ö—É–ø–∏—Ç—å 10 –æ—á–∫–æ–≤ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∑–∞ 100 –∂–µ—Ç–æ–Ω–æ–≤',
                    price: 100,
                    type: 'rating',
                    effect: { rating: 10 },
                    icon: 'trophy',
                    iconClass: 'rating'
                },
                {
                    id: 'skip_penalty_removal',
                    name: '–°–Ω—è—Ç–∏–µ —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –ø—Ä–æ–ø—É—Å–∫',
                    description: '–£–±—Ä–∞—Ç—å —à—Ç—Ä–∞—Ñ –∑–∞ –æ–¥–∏–Ω –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –º–∞—Ç—á',
                    price: 100,
                    type: 'skip_penalty',
                    effect: { skips: 1 },
                    icon: 'shield-alt',
                    iconClass: 'skip'
                },
                {
                    id: 'double_tokens_next_match',
                    name: '–î—É–±–ª–∏–∫–∞—Ç–æ—Ä –∂–µ—Ç–æ–Ω–æ–≤',
                    description: '–ù–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–∞—Ç—á —Å—Ç–∞–≤–∫–∏ –ø—Ä–∏–Ω–æ—Å—è—Ç 2x –∂–µ—Ç–æ–Ω–æ–≤',
                    price: 50,
                    type: 'double_tokens',
                    effect: { multiplier: 2, matches: 1 },
                    icon: 'coins',
                    iconClass: 'double',
                    featured: true
                }
            ];
            
            loadShop();
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
        function loadShop() {
            const grid = document.getElementById('shop-grid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            shopItems.forEach(item => {
                const shopItem = document.createElement('div');
                shopItem.className = `shop-item ${item.featured ? 'featured' : ''}`;
                
                shopItem.innerHTML = `
                    <div class="item-icon ${item.iconClass}">
                        <i class="fas fa-${item.icon}"></i>
                    </div>
                    <h3 style="margin-bottom: 0.5rem;">${item.name}</h3>
                    <div class="item-price">
                        <i class="fas fa-coins"></i> ${item.price}
                    </div>
                    <div class="item-description">
                        ${item.description}
                    </div>
                    ${currentUser ? `
                        <button onclick="buyItem('${item.id}')" class="bet-btn ${item.featured ? 'warning' : 'success'}" style="width: 100%;">
                            <i class="fas fa-shopping-cart"></i> –ö—É–ø–∏—Ç—å
                        </button>
                    ` : `
                        <button onclick="showNotification('–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫—É–ø–∞—Ç—å —Ç–æ–≤–∞—Ä—ã', 'error')" class="bet-btn" style="width: 100%;" disabled>
                            <i class="fas fa-lock"></i> –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—Ö–æ–¥
                        </button>
                    `}
                `;
                
                grid.appendChild(shopItem);
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ç—á–µ–π –° –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ú –û–ë–ù–û–í–õ–ï–ù–ò–ï–ú
        async function loadMatchesData() {
            try {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–∞—Ç—á–µ–π...');
                
                // –î–æ–±–∞–≤–ª—è–µ–º timestamp –¥–ª—è –æ–±—Ö–æ–¥–∞ –∫—ç—à–∞
                const { data, error } = await db
                    .from('bet_matches')
                    .select('*')
                    .in('status', ['live', 'pending', 'finished'])
                    .order('date', { ascending: false })
                    .limit(50);
                
                if (error) throw error;
                
                allMatches = data || [];
                console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–∞—Ç—á–µ–π: ${allMatches.length}`);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ
                if (allMatches.length === 0) {
                    console.warn('‚ö†Ô∏è –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –º–∞—Ç—á–∞—Ö!');
                    createTestMatches();
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞—Ç—á–µ–π:', error);
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –º–∞—Ç—á–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                createTestMatches();
                throw error;
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–∞—Ç—á–µ–π
        function createTestMatches() {
            console.log('–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–∞—Ç—á–µ–π...');
            const now = new Date();
            const tomorrow = new Date(now.getTime() + 24 * 60 * 60 * 1000);
            
            allMatches = [
                {
                    id: 'test_match_1',
                    player1: allPlayers[0]?.name || '–ò–≥—Ä–æ–∫ 1',
                    player2: allPlayers[1]?.name || '–ò–≥—Ä–æ–∫ 2',
                    player1_rating: 1500,
                    player2_rating: 1450,
                    date: now.toISOString(),
                    status: 'live',
                    odds: { player1: 1.8, player2: 2.0 }
                },
                {
                    id: 'test_match_2',
                    player1: allPlayers[1]?.name || '–ò–≥—Ä–æ–∫ 2',
                    player2: allPlayers[2]?.name || '–ò–≥—Ä–æ–∫ 3',
                    player1_rating: 1450,
                    player2_rating: 1400,
                    date: tomorrow.toISOString(),
                    status: 'pending',
                    odds: { player1: 1.9, player2: 1.9 }
                }
            ];
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function updateStats() {
            try {
                // –ò–≥—Ä–æ–∫–∏
                document.getElementById('total-players').textContent = allPlayers.length;
                
                // LIVE –º–∞—Ç—á–∏
                const liveMatches = allMatches.filter(m => m.status === 'live');
                document.getElementById('live-matches').textContent = liveMatches.length;
                
                // –ñ–µ—Ç–æ–Ω—ã
                const totalTokens = playerCabinets.reduce((sum, pc) => sum + (pc.tokens || 0), 0);
                document.getElementById('total-bets').textContent = totalTokens;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ LIVE –º–∞—Ç—á–µ–π
        function loadLiveMatches() {
            const grid = document.getElementById('live-matches-grid');
            if (!grid) return;
            
            const liveMatches = allMatches.filter(m => m.status === 'live' || m.status === 'pending');
            
            if (liveMatches.length === 0) {
                grid.innerHTML = `
                    <div style="text-align: center; padding: 3rem; grid-column: 1 / -1;">
                        <i class="fas fa-calendar-times" style="font-size: 3rem; color: var(--gray-light); margin-bottom: 1rem;"></i>
                        <h3 style="margin-bottom: 0.5rem;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ç—á–µ–π</h3>
                        <p style="color: var(--gray);">–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏, —Å–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ –º–∞—Ç—á–∏!</p>
                        <button onclick="forceReloadMatches()" class="bet-btn" style="margin-top: 1rem;">
                            <i class="fas fa-sync-alt"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                        </button>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = '';
            liveMatches.forEach(match => {
                const matchCard = createMatchCard(match);
                grid.appendChild(matchCard);
            });
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –º–∞—Ç—á–∞
        function createMatchCard(match) {
            const matchCard = document.createElement('div');
            matchCard.className = 'match-card';
            
            const player1 = allPlayers.find(p => p.name === match.player1);
            const player2 = allPlayers.find(p => p.name === match.player2);
            
            const player1Rating = player1 ? parseInt(player1.rating) : (match.player1_rating || 1000);
            const player2Rating = player2 ? parseInt(player2.rating) : (match.player2_rating || 1000);
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∏–ª–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–æ–≤—ã–µ
            let odds;
            if (match.odds && typeof match.odds === 'object') {
                odds = match.odds;
            } else {
                odds = calculateOdds(player1Rating, player2Rating);
            }
            
            matchCard.innerHTML = `
                <div class="match-header">
                    <div>
                        <small>${new Date(match.date).toLocaleDateString('ru-RU')}</small>
                    </div>
                    <span class="match-status ${match.status === 'live' ? 'status-live' : ''}">
                        ${match.status === 'live' ? 'LIVE' : '–°–∫–æ—Ä–æ'}
                    </span>
                </div>
                <div class="match-players">
                    <div class="player">
                        ${player1 && player1.avatar ? 
                            `<img src="${player1.avatar}" alt="${match.player1}" class="player-avatar-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` : 
                            ''
                        }
                        <div class="player-avatar" style="${player1 && player1.avatar ? 'display: none;' : ''}">
                            ${match.player1 ? match.player1.charAt(0).toUpperCase() : '?'}
                        </div>
                        <div class="player-name">${match.player1 || '–ò–≥—Ä–æ–∫ 1'}</div>
                        <div class="player-rating">${player1Rating}</div>
                    </div>
                    <div class="vs">VS</div>
                    <div class="player">
                        ${player2 && player2.avatar ? 
                            `<img src="${player2.avatar}" alt="${match.player2}" class="player-avatar-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` : 
                            ''
                        }
                        <div class="player-avatar" style="${player2 && player2.avatar ? 'display: none;' : ''}">
                            ${match.player2 ? match.player2.charAt(0).toUpperCase() : '?'}
                        </div>
                        <div class="player-name">${match.player2 || '–ò–≥—Ä–æ–∫ 2'}</div>
                        <div class="player-rating">${player2Rating}</div>
                    </div>
                </div>
                <div class="match-odds">
                    <button class="odds-btn" onclick="selectBet('${match.id}', 'player1', ${odds.player1 || 1.8}, '${match.player1}')">
                        –ü1
                        <span class="odds-value">${(odds.player1 || 1.8).toFixed(2)}</span>
                    </button>
                    <button class="odds-btn" onclick="selectBet('${match.id}', 'player2', ${odds.player2 || 1.9}, '${match.player2}')">
                        –ü2
                        <span class="odds-value">${(odds.player2 || 1.9).toFixed(2)}</span>
                    </button>
                </div>
                ${match.status === 'live' && currentUser ? `
                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #eee;">
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <input type="number" id="bet-amount-${match.id}" placeholder="–°—É–º–º–∞" min="1" max="${Math.floor((currentUser.tokens || 0) * 0.5)}" style="flex: 1; padding: 0.5rem; border: 1px solid #ddd; border-radius: 0.25rem;">
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button onclick="placeBet('${match.id}')" class="bet-btn" style="flex: 1; padding: 0.5rem;">
                            <i class="fas fa-coins"></i> –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É
                        </button>
                    </div>
                    <div id="bet-info-${match.id}" style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--gray);">
                        ${selectedBets[match.id] ? `–í—ã–±—Ä–∞–Ω–æ: ${selectedBets[match.id].playerName} (–∫–æ—ç—Ñ. ${selectedBets[match.id].odds.toFixed(2)})` : '–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞'}
                    </div>
                </div>
                ` : ''}
            `;
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è —ç—Ç–æ–≥–æ –º–∞—Ç—á–∞, –≤—ã–¥–µ–ª—è–µ–º –∫–Ω–æ–ø–∫—É
            setTimeout(() => {
                if (selectedBets[match.id]) {
                    const oddsBtns = matchCard.querySelectorAll('.odds-btn');
                    oddsBtns.forEach(btn => {
                        if (btn.textContent.includes(selectedBets[match.id].betOn === 'player1' ? '–ü1' : '–ü2')) {
                            btn.classList.add('selected');
                        }
                    });
                }
            }, 100);
            
            return matchCard;
        }

        // –í—ã–±–æ—Ä —Å—Ç–∞–≤–∫–∏
        function selectBet(matchId, betOn, odds, playerName) {
            const matchCard = document.querySelector(`#bet-amount-${matchId}`)?.closest('.match-card');
            if (!matchCard) return;
            
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            const oddsBtns = matchCard.querySelectorAll('.odds-btn');
            oddsBtns.forEach(btn => btn.classList.remove('selected'));
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–Ω–æ–ø–∫—É
            const selectedBtn = Array.from(oddsBtns).find(btn => 
                btn.textContent.includes(betOn === 'player1' ? '–ü1' : '–ü2')
            );
            if (selectedBtn) {
                selectedBtn.classList.add('selected');
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ç–∞–≤–∫—É
            selectedBets[matchId] = {
                betOn: betOn,
                odds: odds,
                playerName: playerName
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±–æ—Ä–µ
            const betInfo = document.getElementById(`bet-info-${matchId}`);
            if (betInfo) {
                betInfo.textContent = `–í—ã–±—Ä–∞–Ω–æ: ${playerName} (–∫–æ—ç—Ñ. ${odds.toFixed(2)})`;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏
            const input = document.getElementById(`bet-amount-${matchId}`);
            if (input && currentUser) {
                const maxBet = Math.floor((currentUser.tokens || 0) * 0.5);
                input.max = maxBet;
                input.placeholder = `–°—É–º–º–∞ (–º–∞–∫—Å: ${maxBet})`;
            }
        }

        // –†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
        function calculateOdds(rating1, rating2) {
            const diff = Math.abs(rating1 - rating2);
            let favoriteOdds = 1.3;
            let underdogOdds = 3.5;
            
            if (diff < 100) {
                favoriteOdds = 1.8;
                underdogOdds = 1.9;
            } else if (diff < 200) {
                favoriteOdds = 1.5;
                underdogOdds = 2.5;
            } else if (diff < 300) {
                favoriteOdds = 1.4;
                underdogOdds = 3.0;
            }
            
            if (rating1 > rating2) {
                return {
                    player1: favoriteOdds,
                    player2: underdogOdds,
                    favorite: 'player1'
                };
            } else {
                return {
                    player1: underdogOdds,
                    player2: favoriteOdds,
                    favorite: 'player2'
                };
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤
        function loadLeaderboard() {
            const tbody = document.getElementById('leaderboard-body');
            if (!tbody) return;
            
            if (allPlayers.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 3rem;">
                            <i class="fas fa-users" style="font-size: 2rem; color: var(--gray-light); margin-bottom: 1rem; display: block;"></i>
                            <h3 style="margin-bottom: 0.5rem;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∏–≥—Ä–æ–∫–∞—Ö</h3>
                            <p style="color: var(--gray);">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
                            <button onclick="forceReloadLeaderboard()" class="bet-btn small" style="margin-top: 1rem;">
                                <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                            </button>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = '';
            
            allPlayers.slice(0, 10).forEach((player, index) => {
                const matches = parseInt(player.matches) || 0;
                const wins = parseInt(player.wins) || 0;
                const winRate = matches > 0 ? Math.round((wins / matches) * 100) : 0;
                const cabinet = playerCabinets.find(pc => pc.player_name === player.name);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="player-rank">${index + 1}</td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            ${player.avatar ? 
                                `<img src="${player.avatar}" alt="${player.name}" class="player-avatar-small" onerror="this.style.display='none'">` : 
                                ''
                            }
                            <div>${player.name}</div>
                        </div>
                    </td>
                    <td><strong>${player.rating || 1000}</strong></td>
                    <td>${matches}</td>
                    <td>${wins}</td>
                    <td>${winRate}%</td>
                `;
                tbody.appendChild(row);
            });
        }

        // –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function loginUser() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            
            if (!username || !password) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å', 'error');
                return;
            }
            
            try {
                const { data, error } = await db
                    .from('player_cabinets')
                    .select('*')
                    .eq('login', username)
                    .eq('password', password);
                
                if (error) throw error;
                
                if (data && data.length > 0) {
                    currentUser = data[0];
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    showNotification('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                    closeModal('loginModal');
                    updateNavForUser();
                    loadLiveMatches();
                    loadShop();
                } else {
                    showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message, 'error');
            }
        }

        // –ü–æ–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–∞
        async function buyItem(itemId) {
            if (!currentUser) {
                showNotification('–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫—É–ø–∞—Ç—å —Ç–æ–≤–∞—Ä—ã', 'error');
                return;
            }
            
            const item = shopItems.find(i => i.id === itemId);
            if (!item) {
                showNotification('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            if ((currentUser.tokens || 0) < item.price) {
                showNotification(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤. –ù—É–∂–Ω–æ: ${item.price}, —É –≤–∞—Å: ${currentUser.tokens || 0}`, 'error');
                return;
            }
            
            try {
                // –°–ø–∏—Å—ã–≤–∞–µ–º –∂–µ—Ç–æ–Ω—ã
                const newTokens = (currentUser.tokens || 0) - item.price;
                
                const { error: updateError } = await db
                    .from('player_cabinets')
                    .update({ tokens: newTokens })
                    .eq('id', currentUser.id);
                
                if (updateError) throw updateError;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø–æ–∫—É–ø–∫–∏
                if (item.type === 'rating') {
                    const player = allPlayers.find(p => p.name === currentUser.player_name);
                    if (player) {
                        const newRating = parseInt(player.rating) + item.effect.rating;
                        await db
                            .from('players')
                            .update({ rating: newRating })
                            .eq('name', currentUser.player_name);
                    }
                }
                
                // –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –æ –ø–æ–∫—É–ø–∫–µ
                const purchaseId = 'purchase_' + Date.now().toString(36);
                
                try {
                    const { error: purchaseError } = await db
                        .from('player_purchases')
                        .insert([{
                            id: purchaseId,
                            player_name: currentUser.player_name,
                            item_id: itemId,
                            item_name: item.name,
                            price: item.price,
                            type: item.type,
                            effect: item.effect,
                            created_at: new Date().toISOString()
                        }]);
                    
                    if (purchaseError) {
                        // –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ–º –µ–µ
                        if (purchaseError.message.includes("Could not find the table")) {
                            // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º, –ø–æ–∫—É–ø–∫–∞ –≤—Å–µ —Ä–∞–≤–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –±–∞–ª–∞–Ω—Å–∞
                            console.log('–¢–∞–±–ª–∏—Ü–∞ –ø–æ–∫—É–ø–æ–∫ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–¥–∏–º –ø–æ–∑–∂–µ');
                        } else {
                            throw purchaseError;
                        }
                    }
                } catch (error) {
                    console.log('–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –ø–æ–∫—É–ø–∫–∏:', error.message);
                    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º, —Ç–∞–∫ –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (—Å–ø–∏—Å–∞–Ω–∏–µ –∂–µ—Ç–æ–Ω–æ–≤) –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                currentUser.tokens = newTokens;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                await loadPlayersData();
                await loadPurchasesData();
                
                showNotification(`–í—ã —É—Å–ø–µ—à–Ω–æ –∫—É–ø–∏–ª–∏ "${item.name}" –∑–∞ ${item.price} –∂–µ—Ç–æ–Ω–æ–≤!`, 'success');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
                loadShop();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –µ—Å–ª–∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç
                if (document.getElementById('playerModal').style.display === 'block') {
                    showPlayerInfo();
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏: ' + error.message, 'error');
            }
        }

        // –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function enterAdminPanel() {
            const password = document.getElementById('adminPassword').value;
            const ADMIN_PASSWORD = 'admin123';
            
            if (password === ADMIN_PASSWORD) {
                isAdmin = true;
                showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!', 'success');
                closeModal('adminModal');
                showAdminPanel();
            } else {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞', 'error');
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        async function showAdminPanel() {
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                await loadPlayersData();
                await loadMatchesData();
                await loadPurchasesData();
                
                const adminPanel = document.createElement('div');
                adminPanel.className = 'admin-panel';
                
                adminPanel.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid var(--gray-light);">
                        <h2 style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-cog"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                        </h2>
                        <button onclick="closeAdminPanel()" class="bet-btn danger" style="padding: 0.5rem 1rem;">
                            <i class="fas fa-times"></i> –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                    
                    <div class="admin-grid">
                        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏ -->
                        <div class="admin-section">
                            <h3><i class="fas fa-users"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏ (${allPlayers.length})</h3>
                            <div class="player-list">
                                ${allPlayers.map(player => {
                                    const cabinet = playerCabinets.find(pc => pc.player_name === player.name);
                                    const playerPurchasesList = playerPurchases.filter(p => p.player_name === player.name);
                                    const winRate = player.matches > 0 ? Math.round((player.wins / player.matches) * 100) : 0;
                                    return `
                                    <div class="player-item">
                                        <div class="player-info">
                                            <strong>${player.name}</strong><br>
                                            <small>
                                                –†–µ–π—Ç–∏–Ω–≥: ${player.rating} | 
                                                –ú–∞—Ç—á–∏: ${player.matches} | 
                                                –ü–æ–±–µ–¥—ã: ${player.wins} (${winRate}%)<br>
                                                ${cabinet ? `–ñ–µ—Ç–æ–Ω—ã: ${cabinet.tokens || 0}` : '<span style="color: orange;">–ö–∞–±–∏–Ω–µ—Ç –Ω–µ —Å–æ–∑–¥–∞–Ω</span>'}
                                            </small>
                                            ${playerPurchasesList.length > 0 ? `
                                                <div class="player-purchases">
                                                    <strong>–ü–æ–∫—É–ø–∫–∏ (${playerPurchasesList.length}):</strong>
                                                    ${playerPurchasesList.slice(0, 2).map(purchase => `
                                                        <div class="purchase-item">
                                                            <span>${purchase.item_name}</span>
                                                            <span>-${purchase.price} –∂–µ—Ç–æ–Ω–æ–≤</span>
                                                        </div>
                                                    `).join('')}
                                                    ${playerPurchasesList.length > 2 ? `<small>... –∏ –µ—â–µ ${playerPurchasesList.length - 2}</small>` : ''}
                                                </div>
                                            ` : ''}
                                        </div>
                                        <div class="player-actions">
                                            ${cabinet ? `
                                                <button class="action-btn add-tokens" onclick="showAddTokensModal('${cabinet.id}', '${player.name}')">
                                                    <i class="fas fa-plus"></i>
                                                </button>
                                            ` : `
                                                <button class="action-btn add-tokens" onclick="createCabinet('${player.name}')">
                                                    <i class="fas fa-user-plus"></i>
                                                </button>
                                            `}
                                            <button class="action-btn add-tokens" onclick="showPlayerPurchases('${player.name}')" title="–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫">
                                                <i class="fas fa-history"></i>
                                            </button>
                                        </div>
                                    </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                        
                        <!-- –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–∞ -->
                        <div class="admin-section">
                            <h3><i class="fas fa-trophy"></i> –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á</h3>
                            <div class="form-group">
                                <label>–ò–≥—Ä–æ–∫ 1:</label>
                                <select id="matchPlayer1" style="width: 100%;">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</option>
                                    ${allPlayers.map(p => `
                                        <option value="${p.name}">${p.name} (–†–µ–π—Ç–∏–Ω–≥: ${p.rating})</option>
                                    `).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–ò–≥—Ä–æ–∫ 2:</label>
                                <select id="matchPlayer2" style="width: 100%;">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</option>
                                    ${allPlayers.map(p => `
                                        <option value="${p.name}">${p.name} (–†–µ–π—Ç–∏–Ω–≥: ${p.rating})</option>
                                    `).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</label>
                                <input type="datetime-local" id="matchDate" value="${new Date(Date.now() + 3600000).toISOString().slice(0, 16)}" style="width: 100%;">
                            </div>
                            <button onclick="createMatch()" class="bet-btn" style="width: 100%;">
                                <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á
                            </button>
                        </div>
                        
                        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∞–º–∏ -->
                        <div class="admin-section">
                            <h3><i class="fas fa-list"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∞–º–∏ (${allMatches.length})</h3>
                            <div class="player-list">
                                ${allMatches.map(match => {
                                    const player1 = allPlayers.find(p => p.name === match.player1);
                                    const player2 = allPlayers.find(p => p.name === match.player2);
                                    return `
                                    <div class="player-item">
                                        <div class="player-info">
                                            <strong>${match.player1} vs ${match.player2}</strong><br>
                                            <small>
                                                ${new Date(match.date).toLocaleString('ru-RU')} | 
                                                –°—Ç–∞—Ç—É—Å: ${getStatusText(match.status)}<br>
                                                ${match.status === 'finished' ? `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${match.result}` : ''}
                                            </small>
                                        </div>
                                        <div class="player-actions">
                                            ${match.status !== 'finished' ? `
                                                <button class="action-btn add-tokens small" onclick="updateMatchStatus('${match.id}', 'live')">
                                                    ${match.status === 'live' ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è'}
                                                </button>
                                                <button class="action-btn add-tokens small" onclick="finalizeMatch('${match.id}', 'player1')">
                                                    –ü1
                                                </button>
                                                <button class="action-btn add-tokens small" onclick="finalizeMatch('${match.id}', 'player2')">
                                                    –ü2
                                                </button>
                                            ` : '‚úÖ'}
                                        </div>
                                    </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                        
                        <!-- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∂–µ—Ç–æ–Ω–æ–≤ -->
                        <div class="admin-section">
                            <h3><i class="fas fa-coins"></i> –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∂–µ—Ç–æ–Ω–æ–≤</h3>
                            <div class="form-group">
                                <label>–ò–≥—Ä–æ–∫ —Å –∫–∞–±–∏–Ω–µ—Ç–æ–º:</label>
                                <select id="playerForTokens" style="width: 100%;">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</option>
                                    ${playerCabinets.map(pc => `
                                        <option value="${pc.id}">${pc.player_name} (—Å–µ–π—á–∞—Å: ${pc.tokens || 0})</option>
                                    `).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤:</label>
                                <input type="number" id="tokensAmount" value="100" min="1" style="width: 100%;">
                            </div>
                            <button onclick="addTokensToPlayer()" class="bet-btn success" style="width: 100%;">
                                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∂–µ—Ç–æ–Ω—ã
                            </button>
                        </div>
                        
                        <!-- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–∫—É–ø–æ–∫ -->
                        <div class="admin-section">
                            <h3><i class="fas fa-shopping-cart"></i> –í—Å–µ –ø–æ–∫—É–ø–∫–∏ (${playerPurchases.length})</h3>
                            <div style="margin-bottom: 1rem;">
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                    <input type="text" id="searchPurchases" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–≥—Ä–æ–∫—É..." style="flex: 1; padding: 0.5rem; border: 1px solid #ddd; border-radius: 0.25rem;">
                                    <select id="filterPurchaseType" style="padding: 0.5rem; border: 1px solid #ddd; border-radius: 0.25rem;">
                                        <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
                                        <option value="rating">–†–µ–π—Ç–∏–Ω–≥</option>
                                        <option value="skip_penalty">–ü—Ä–æ–ø—É—Å–∫</option>
                                        <option value="double_tokens">–î—É–±–ª–∏–∫–∞—Ç–æ—Ä</option>
                                    </select>
                                    <button onclick="loadAllPurchases()" class="action-btn add-tokens">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="purchasesList" class="player-list" style="max-height: 400px; overflow-y: auto;">
                                <div class="loading">
                                    <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–∫—É–ø–æ–∫...
                                </div>
                            </div>
                        </div>
                        
                        <!-- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫ -->
                        <div class="admin-section">
                            <h3><i class="fas fa-list-check"></i> –í—Å–µ —Å—Ç–∞–≤–∫–∏</h3>
                            <div style="margin-bottom: 1rem;">
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                    <input type="text" id="searchBets" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–≥—Ä–æ–∫—É..." style="flex: 1; padding: 0.5rem; border: 1px solid #ddd; border-radius: 0.25rem;">
                                    <select id="filterBetStatus" style="padding: 0.5rem; border: 1px solid #ddd; border-radius: 0.25rem;">
                                        <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                        <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                                        <option value="won">–í—ã–∏–≥—Ä–∞–Ω–Ω—ã–µ</option>
                                        <option value="lost">–ü—Ä–æ–∏–≥—Ä–∞–Ω–Ω—ã–µ</option>
                                        <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
                                    </select>
                                    <button onclick="loadAllBets()" class="action-btn add-tokens">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="betsList" class="player-list" style="max-height: 400px; overflow-y: auto;">
                                <div class="loading">
                                    <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–≤–æ–∫...
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(adminPanel);
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∞–¥–º–∏–Ω–∫–∏
                setTimeout(() => {
                    loadAllPurchases();
                    loadAllBets();
                }, 100);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: ' + error.message, 'error');
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–∫—É–ø–∫–∏ –∏–≥—Ä–æ–∫–∞
        function showPlayerPurchases(playerName) {
            const playerPurchasesList = playerPurchases.filter(p => p.player_name === playerName);
            
            if (playerPurchasesList.length === 0) {
                showNotification(`–£ –∏–≥—Ä–æ–∫–∞ ${playerName} –Ω–µ—Ç –ø–æ–∫—É–ø–æ–∫`, 'info');
                return;
            }
            
            let purchasesHtml = `
                <div style="background: white; padding: 1rem; border-radius: 0.5rem; max-height: 400px; overflow-y: auto;">
                    <h3 style="margin-bottom: 1rem;">–ü–æ–∫—É–ø–∫–∏ –∏–≥—Ä–æ–∫–∞: ${playerName}</h3>
                    <div style="display: grid; gap: 0.5rem;">
                        ${playerPurchasesList.map(purchase => `
                            <div style="padding: 0.75rem; background: #f8fafc; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                                    <strong>${purchase.item_name}</strong>
                                    <span style="color: var(--warning); font-weight: bold;">
                                        <i class="fas fa-coins"></i> ${purchase.price}
                                    </span>
                                </div>
                                <div style="font-size: 0.85rem; color: var(--gray);">
                                    –¢–∏–ø: ${getPurchaseTypeText(purchase.type)}<br>
                                    –î–∞—Ç–∞: ${new Date(purchase.created_at).toLocaleString('ru-RU')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; text-align: center;">
                        <strong>–í—Å–µ–≥–æ –ø–æ–∫—É–ø–æ–∫: ${playerPurchasesList.length}</strong><br>
                        <small>–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${playerPurchasesList.reduce((sum, p) => sum + p.price, 0)} –∂–µ—Ç–æ–Ω–æ–≤</small>
                    </div>
                </div>
            `;
            
            showNotificationWithHtml(purchasesHtml, 'info');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –ø–æ–∫—É–ø–æ–∫
        function loadAllPurchases() {
            try {
                const purchasesList = document.getElementById('purchasesList');
                if (!purchasesList) return;
                
                purchasesList.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–∫—É–ø–æ–∫...</div>';
                
                if (playerPurchases.length === 0) {
                    purchasesList.innerHTML = `
                        <div style="padding: 1rem; text-align: center;">
                            <div style="color: var(--gray); margin-bottom: 0.5rem;">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <div style="margin-bottom: 1rem;">
                                –ü–æ–∫—É–ø–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
                                <br>
                                <small>–ò–≥—Ä–æ–∫–∏ –µ—â–µ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫—É–ø–∞–ª–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ</small>
                            </div>
                        </div>
                    `;
                    return;
                }
                
                const searchTerm = document.getElementById('searchPurchases').value.toLowerCase();
                const typeFilter = document.getElementById('filterPurchaseType').value;
                
                purchasesList.innerHTML = '';
                
                playerPurchases.forEach(purchase => {
                    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
                    if (searchTerm && !purchase.player_name.toLowerCase().includes(searchTerm)) return;
                    if (typeFilter !== 'all' && purchase.type !== typeFilter) return;
                    
                    const purchaseItem = document.createElement('div');
                    purchaseItem.className = 'player-item';
                    
                    purchaseItem.innerHTML = `
                        <div class="player-info">
                            <strong>${purchase.player_name}</strong>
                            <br>
                            <small>
                                –¢–æ–≤–∞—Ä: <strong>${purchase.item_name}</strong><br>
                                –¢–∏–ø: <span style="color: ${getPurchaseTypeColor(purchase.type)}; font-weight: 600;">
                                    ${getPurchaseTypeText(purchase.type)}
                                </span>
                            </small>
                            <br>
                            <small>
                                –°—Ç–æ–∏–º–æ—Å—Ç—å: <strong style="color: var(--warning);">${purchase.price} –∂–µ—Ç–æ–Ω–æ–≤</strong>
                            </small>
                            <br>
                            <small style="color: var(--gray); font-size: 0.7rem;">
                                ${new Date(purchase.created_at).toLocaleString('ru-RU')}
                            </small>
                        </div>
                    `;
                    
                    purchasesList.appendChild(purchaseItem);
                });
                
                if (purchasesList.children.length === 0) {
                    purchasesList.innerHTML = '<div class="loading">–ü–æ–∫—É–ø–æ–∫ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∫—É–ø–æ–∫:', error);
                const purchasesList = document.getElementById('purchasesList');
                if (purchasesList) {
                    purchasesList.innerHTML = '<div class="error-message">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∫—É–ø–æ–∫: ' + error.message + '</div>';
                }
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getStatusText(status) {
            const statusMap = {
                'pending': '–û–∂–∏–¥–∞–Ω–∏–µ',
                'live': 'LIVE',
                'finished': '–ó–∞–≤–µ—Ä—à–µ–Ω'
            };
            return statusMap[status] || status;
        }

        function getPurchaseTypeText(type) {
            const typeMap = {
                'rating': '–†–µ–π—Ç–∏–Ω–≥',
                'skip_penalty': '–°–Ω—è—Ç–∏–µ —à—Ç—Ä–∞—Ñ–∞',
                'double_tokens': '–î—É–±–ª–∏–∫–∞—Ç–æ—Ä –∂–µ—Ç–æ–Ω–æ–≤'
            };
            return typeMap[type] || type;
        }

        function getPurchaseTypeColor(type) {
            const colorMap = {
                'rating': '#f59e0b',
                'skip_penalty': '#10b981',
                'double_tokens': '#8b5cf6'
            };
            return colorMap[type] || '#6b7280';
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function closeAdminPanel() {
            const panel = document.querySelector('.admin-panel');
            if (panel) panel.remove();
        }

        async function createMatch() {
            const player1Name = document.getElementById('matchPlayer1').value;
            const player2Name = document.getElementById('matchPlayer2').value;
            const date = document.getElementById('matchDate').value;
            
            if (!player1Name || !player2Name || player1Name === player2Name) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤', 'error');
                return;
            }
            
            if (!date) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –º–∞—Ç—á–∞', 'error');
                return;
            }
            
            try {
                const player1 = allPlayers.find(p => p.name === player1Name);
                const player2 = allPlayers.find(p => p.name === player2Name);
                
                const player1Rating = player1 ? parseInt(player1.rating) : 1000;
                const player2Rating = player2 ? parseInt(player2.rating) : 1000;
                
                const odds = calculateOdds(player1Rating, player2Rating);
                const matchId = 'match_' + Date.now().toString(36);
                
                const { error } = await db
                    .from('bet_matches')
                    .insert([{
                        id: matchId,
                        player1: player1Name,
                        player2: player2Name,
                        player1_rating: player1Rating,
                        player2_rating: player2Rating,
                        date: date,
                        status: 'pending',
                        odds: odds,
                        created_at: new Date().toISOString()
                    }]);
                
                if (error) throw error;
                
                showNotification('–ú–∞—Ç—á —Å–æ–∑–¥–∞–Ω!', 'success');
                await loadMatchesData();
                closeAdminPanel();
                showAdminPanel();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞: ' + error.message, 'error');
            }
        }

        async function createCabinet(playerName) {
            if (!confirm(`–°–æ–∑–¥–∞—Ç—å –∫–∞–±–∏–Ω–µ—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞ ${playerName}?`)) return;
            
            try {
                const login = playerName.toLowerCase().replace(/\s+/g, '_') + '_' + Date.now().toString(36);
                const password = Math.random().toString(36).slice(-8);
                
                const { error } = await db
                    .from('player_cabinets')
                    .insert([{
                        player_name: playerName,
                        login: login,
                        password: password,
                        tokens: 100,
                        join_date: new Date().toISOString()
                    }]);
                
                if (error) throw error;
                
                await loadPlayersData();
                showNotification(`–ö–∞–±–∏–Ω–µ—Ç —Å–æ–∑–¥–∞–Ω! –õ–æ–≥–∏–Ω: ${login}, –ü–∞—Ä–æ–ª—å: ${password}`, 'success');
                closeAdminPanel();
                showAdminPanel();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–±–∏–Ω–µ—Ç–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–±–∏–Ω–µ—Ç–∞: ' + error.message, 'error');
            }
        }

        async function addTokensToPlayer() {
            const cabinetId = document.getElementById('playerForTokens').value;
            const amount = parseInt(document.getElementById('tokensAmount').value) || 100;
            
            if (!cabinetId) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞', 'error');
                return;
            }
            
            if (amount <= 0) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤', 'error');
                return;
            }
            
            try {
                const cabinet = playerCabinets.find(pc => pc.id === cabinetId);
                if (!cabinet) {
                    showNotification('–ö–∞–±–∏–Ω–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    return;
                }
                
                const newTokens = (cabinet.tokens || 0) + amount;
                
                const { error } = await db
                    .from('player_cabinets')
                    .update({ tokens: newTokens })
                    .eq('id', cabinetId);
                
                if (error) throw error;
                
                await loadPlayersData();
                showNotification(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${amount} –∂–µ—Ç–æ–Ω–æ–≤ –∏–≥—Ä–æ–∫—É ${cabinet.player_name}`, 'success');
                closeAdminPanel();
                showAdminPanel();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–æ–≤:', error);
                showNotification('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–æ–≤: ' + error.message, 'error');
            }
        }

        async function updateMatchStatus(matchId, status) {
            try {
                const { error } = await db
                    .from('bet_matches')
                    .update({ status: status })
                    .eq('id', matchId);
                
                if (error) throw error;
                
                showNotification(`–°—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞ –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ ${status === 'live' ? 'LIVE' : '–û–∂–∏–¥–∞–Ω–∏–µ'}`, 'success');
                await loadMatchesData();
                closeAdminPanel();
                showAdminPanel();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞: ' + error.message, 'error');
            }
        }

        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–∞—Ç—á–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å—Ç–∞–≤–æ–∫
        async function finalizeMatch(matchId, winner) {
            if (!confirm(`–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–±–µ–¥—É ${winner === 'player1' ? '–ø–µ—Ä–≤–æ–≥–æ' : '–≤—Ç–æ—Ä–æ–≥–æ'} –∏–≥—Ä–æ–∫–∞? –í—Å–µ —Å—Ç–∞–≤–∫–∏ –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã.`)) return;
            
            try {
                const match = allMatches.find(m => m.id === matchId);
                if (!match) {
                    showNotification('–ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    return;
                }
                
                // 1. –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞
                const { error: matchError } = await db
                    .from('bet_matches')
                    .update({ 
                        status: 'finished',
                        result: winner,
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', matchId);
                
                if (matchError) throw matchError;
                
                // 2. –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á
                let bets = [];
                try {
                    const { data: betsData, error: betsError } = await db
                        .from('player_bets')
                        .select('*')
                        .eq('match_id', matchId)
                        .eq('status', 'active');
                    
                    if (betsError && !betsError.message.includes("Could not find the table")) {
                        throw betsError;
                    }
                    
                    bets = betsData || [];
                } catch (error) {
                    // –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞–≤–æ–∫ –º–æ–∂–µ—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
                    console.log('–°—Ç–∞–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞:', error.message);
                }
                
                // 3. –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞–≤–∫–∏ –∏ –Ω–∞—á–∏—Å–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à–∏
                if (bets && bets.length > 0) {
                    let wonBetsCount = 0;
                    let totalWonAmount = 0;
                    
                    for (const bet of bets) {
                        let newStatus = '';
                        let actualWin = 0;
                        
                        if (bet.bet_on === winner) {
                            // –°—Ç–∞–≤–∫–∞ –≤—ã–∏–≥—Ä–∞–ª–∞
                            newStatus = 'won';
                            actualWin = Math.round(bet.amount * bet.odds);
                            wonBetsCount++;
                            totalWonAmount += actualWin;
                            
                            // –ù–∞—á–∏—Å–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à –∏–≥—Ä–æ–∫—É
                            const { data: cabinet } = await db
                                .from('player_cabinets')
                                .select('*')
                                .eq('player_name', bet.player_name)
                                .single();
                            
                            if (cabinet) {
                                const newTokens = (cabinet.tokens || 0) + actualWin;
                                await db
                                    .from('player_cabinets')
                                    .update({ tokens: newTokens })
                                    .eq('player_name', bet.player_name);
                                
                                console.log(`–ù–∞—á–∏—Å–ª–µ–Ω–æ ${actualWin} –∂–µ—Ç–æ–Ω–æ–≤ –∏–≥—Ä–æ–∫—É ${bet.player_name}`);
                            }
                        } else {
                            // –°—Ç–∞–≤–∫–∞ –ø—Ä–æ–∏–≥—Ä–∞–ª–∞
                            newStatus = 'lost';
                            actualWin = 0;
                        }
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Å—Ç–∞–≤–∫–∏
                        await db
                            .from('player_bets')
                            .update({ 
                                status: newStatus,
                                actual_win: actualWin,
                                updated_at: new Date().toISOString()
                            })
                            .eq('id', bet.id);
                    }
                    
                    showNotification(`–ú–∞—Ç—á –∑–∞–≤–µ—Ä—à–µ–Ω! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ ${bets.length} —Å—Ç–∞–≤–æ–∫. –í—ã–∏–≥—Ä–∞–ª–æ ${wonBetsCount} —Å—Ç–∞–≤–æ–∫ –Ω–∞ –æ–±—â—É—é —Å—É–º–º—É ${totalWonAmount} –∂–µ—Ç–æ–Ω–æ–≤`, 'success');
                } else {
                    showNotification('–ú–∞—Ç—á –∑–∞–≤–µ—Ä—à–µ–Ω! (—Å—Ç–∞–≤–æ–∫ –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω–æ)', 'success');
                }
                
                // 4. –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –ø–∞–Ω–µ–ª—å
                await loadMatchesData();
                await loadPlayersData();
                closeAdminPanel();
                showAdminPanel();
                
                // 5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–≤–æ–∫ –≤ –∞–¥–º–∏–Ω–∫–µ
                const betsList = document.getElementById('betsList');
                if (betsList) {
                    setTimeout(() => loadAllBets(), 500);
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∞—Ç—á–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∞—Ç—á–∞: ' + error.message, 'error');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫
        async function loadAllBets() {
            try {
                const betsList = document.getElementById('betsList');
                if (!betsList) return;
                
                betsList.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–≤–æ–∫...</div>';
                
                try {
                    const { data: bets, error } = await db
                        .from('player_bets')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    if (error) {
                        // –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                        if (error.message.includes("Could not find the table") || error.code === 'PGRST205') {
                            betsList.innerHTML = `
                                <div style="padding: 1rem; text-align: center;">
                                    <div style="color: var(--warning); margin-bottom: 0.5rem;">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div style="margin-bottom: 1rem;">
                                        –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞–≤–æ–∫ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞. 
                                        <br>
                                        <small>–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –º–∞—Ç—á–∞ —Å—Ç–∞–≤–∫–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</small>
                                    </div>
                                </div>
                            `;
                            return;
                        }
                        throw error;
                    }
                    
                    if (!bets || bets.length === 0) {
                        betsList.innerHTML = '<div class="loading">–°—Ç–∞–≤–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                        return;
                    }
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞—Ç—á–∞—Ö
                    const matchIds = [...new Set(bets.map(bet => bet.match_id))];
                    const { data: matches } = await db
                        .from('bet_matches')
                        .select('*')
                        .in('id', matchIds);
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∏–≥—Ä–æ–∫–∞—Ö
                    const playerNames = [...new Set(bets.map(bet => bet.player_name))];
                    const { data: cabinets } = await db
                        .from('player_cabinets')
                        .select('*')
                        .in('player_name', playerNames);
                    
                    const searchTerm = document.getElementById('searchBets').value.toLowerCase();
                    const statusFilter = document.getElementById('filterBetStatus').value;
                    
                    betsList.innerHTML = '';
                    
                    bets.forEach(bet => {
                        const match = matches ? matches.find(m => m.id === bet.match_id) : null;
                        const cabinet = cabinets ? cabinets.find(c => c.player_name === bet.player_name) : null;
                        
                        if (!match) return;
                        
                        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
                        if (searchTerm && !bet.player_name.toLowerCase().includes(searchTerm)) return;
                        
                        if (statusFilter !== 'all') {
                            if (statusFilter === 'active' && bet.status !== 'active') return;
                            if (statusFilter === 'won' && bet.status !== 'won') return;
                            if (statusFilter === 'lost' && bet.status !== 'lost') return;
                            if (statusFilter === 'cancelled' && bet.status !== 'cancelled') return;
                        }
                        
                        const betItem = document.createElement('div');
                        betItem.className = 'player-item';
                        
                        const betAmount = parseFloat(bet.amount) || 0;
                        const potentialWin = parseFloat(bet.potential_win) || 0;
                        const actualWin = parseFloat(bet.actual_win) || 0;
                        
                        let statusBadge = '';
                        let statusColor = '';
                        
                        switch(bet.status) {
                            case 'active':
                                statusBadge = 'üü° –ê–∫—Ç–∏–≤–Ω–∞';
                                statusColor = '#f59e0b';
                                break;
                            case 'won':
                                statusBadge = 'üü¢ –í—ã–∏–≥—Ä–∞–Ω–∞';
                                statusColor = '#10b981';
                                break;
                            case 'lost':
                                statusBadge = 'üî¥ –ü—Ä–æ–∏–≥—Ä–∞–Ω–∞';
                                statusColor = '#ef4444';
                                break;
                            case 'cancelled':
                                statusBadge = '‚ö™ –û—Ç–º–µ–Ω–µ–Ω–∞';
                                statusColor = '#6b7280';
                                break;
                            default:
                                statusBadge = 'üü† –í –æ–∂–∏–¥–∞–Ω–∏–∏';
                                statusColor = '#f97316';
                        }
                        
                        const matchInfo = match ? 
                            `${match.player1} vs ${match.player2} (${new Date(match.date).toLocaleDateString('ru-RU')})` : 
                            '–ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω';
                        
                        const betOnName = bet.bet_on === 'player1' ? match.player1 : match.player2;
                        
                        betItem.innerHTML = `
                            <div class="player-info">
                                <strong>${bet.player_name}</strong>
                                ${cabinet ? `<br><small>–¢–æ–∫–µ–Ω—ã: ${cabinet.tokens || 0}</small>` : ''}
                                <br>
                                <small>
                                    –ú–∞—Ç—á: ${matchInfo}<br>
                                    –°—Ç–∞–≤–∫–∞ –Ω–∞: <strong>${betOnName}</strong><br>
                                    –°—É–º–º–∞: <strong>${betAmount}</strong> –∂–µ—Ç–æ–Ω–æ–≤
                                    ${bet.odds ? ` (–∫–æ—ç—Ñ. ${parseFloat(bet.odds).toFixed(2)})` : ''}
                                </small>
                                <br>
                                <small>
                                    ${bet.status === 'active' ? 
                                        `–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à: <strong style="color: var(--success);">${potentialWin.toFixed(2)}</strong>` :
                                        bet.status === 'won' ?
                                        `–í—ã–∏–≥—Ä–∞–Ω–æ: <strong style="color: var(--success);">${actualWin.toFixed(2)}</strong>` :
                                        ''
                                    }
                                    <span style="margin-left: 10px; padding: 2px 6px; border-radius: 10px; background: ${statusColor}20; color: ${statusColor}; font-size: 0.7rem;">
                                        ${statusBadge}
                                    </span>
                                </small>
                                <br>
                                <small style="color: var(--gray); font-size: 0.7rem;">
                                    ${new Date(bet.created_at).toLocaleString('ru-RU')}
                                </small>
                            </div>
                            <div class="player-actions">
                                ${bet.status === 'active' ? `
                                    <button class="action-btn delete small" onclick="cancelBet('${bet.id}', '${bet.player_name}', ${betAmount})" title="–û—Ç–º–µ–Ω–∏—Ç—å —Å—Ç–∞–≤–∫—É">
                                        <i class="fas fa-times"></i>
                                    </button>
                                ` : bet.status === 'cancelled' ? `
                                    <button class="action-btn add-tokens small" onclick="restoreBet('${bet.id}', '${bet.player_name}', ${betAmount})" title="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞–≤–∫—É">
                                        <i class="fas fa-undo"></i>
                                    </button>
                                ` : ''}
                                <button class="action-btn delete small" onclick="deleteBetPermanently('${bet.id}', '${bet.player_name}')" title="–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                        
                        betsList.appendChild(betItem);
                    });
                    
                    if (betsList.children.length === 0) {
                        betsList.innerHTML = '<div class="loading">–°—Ç–∞–≤–æ–∫ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                    }
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–≤–æ–∫:', error);
                    betsList.innerHTML = `
                        <div style="padding: 1rem; text-align: center; color: var(--danger);">
                            <i class="fas fa-exclamation-circle"></i>
                            <div>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–≤–æ–∫</div>
                            <small>${error.message}</small>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–≤–æ–∫:', error);
                const betsList = document.getElementById('betsList');
                if (betsList) {
                    betsList.innerHTML = '<div class="error-message">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–≤–æ–∫: ' + error.message + '</div>';
                }
            }
        }

        // –û—Ç–º–µ–Ω–∞ —Å—Ç–∞–≤–∫–∏
        async function cancelBet(betId, playerName, betAmount) {
            if (!confirm(`–û—Ç–º–µ–Ω–∏—Ç—å —Å—Ç–∞–≤–∫—É –∏–≥—Ä–æ–∫–∞ ${playerName} –Ω–∞ —Å—É–º–º—É ${betAmount} –∂–µ—Ç–æ–Ω–æ–≤? –ñ–µ—Ç–æ–Ω—ã –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã –∏–≥—Ä–æ–∫—É.`)) {
                return;
            }
            
            try {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∂–µ—Ç–æ–Ω—ã –∏–≥—Ä–æ–∫—É
                const { data: cabinet } = await db
                    .from('player_cabinets')
                    .select('*')
                    .eq('player_name', playerName)
                    .single();
                
                if (cabinet) {
                    const newTokens = (cabinet.tokens || 0) + betAmount;
                    
                    await db
                        .from('player_cabinets')
                        .update({ tokens: newTokens })
                        .eq('player_name', playerName);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Å—Ç–∞–≤–∫–∏
                await db
                    .from('player_bets')
                    .update({ 
                        status: 'cancelled',
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', betId);
                
                showNotification(`–°—Ç–∞–≤–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞. ${betAmount} –∂–µ—Ç–æ–Ω–æ–≤ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã –∏–≥—Ä–æ–∫—É ${playerName}`, 'success');
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–≤–æ–∫
                await loadAllBets();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–æ–≤
                await loadPlayersData();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–º–µ–Ω—ã —Å—Ç–∞–≤–∫–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–º–µ–Ω—ã —Å—Ç–∞–≤–∫–∏: ' + error.message, 'error');
            }
        }

        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
        async function restoreBet(betId, playerName, betAmount) {
            if (!confirm(`–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞–≤–∫—É –∏–≥—Ä–æ–∫–∞ ${playerName} –Ω–∞ —Å—É–º–º—É ${betAmount} –∂–µ—Ç–æ–Ω–æ–≤? –ñ–µ—Ç–æ–Ω—ã –±—É–¥—É—Ç —Å–ø–∏—Å–∞–Ω—ã —Å –±–∞–ª–∞–Ω—Å–∞ –∏–≥—Ä–æ–∫–∞.`)) {
                return;
            }
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞
                const { data: cabinet } = await db
                    .from('player_cabinets')
                    .select('*')
                    .eq('player_name', playerName)
                    .single();
                
                if (!cabinet) {
                    showNotification('–ö–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    return;
                }
                
                if ((cabinet.tokens || 0) < betAmount) {
                    showNotification(`–£ –∏–≥—Ä–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤. –¢—Ä–µ–±—É–µ—Ç—Å—è: ${betAmount}, –¥–æ—Å—Ç—É–ø–Ω–æ: ${cabinet.tokens || 0}`, 'error');
                    return;
                }
                
                // –°–ø–∏—Å—ã–≤–∞–µ–º –∂–µ—Ç–æ–Ω—ã
                const newTokens = (cabinet.tokens || 0) - betAmount;
                
                await db
                    .from('player_cabinets')
                    .update({ tokens: newTokens })
                    .eq('player_name', playerName);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Å—Ç–∞–≤–∫–∏
                await db
                    .from('player_bets')
                    .update({ 
                        status: 'active',
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', betId);
                
                showNotification(`–°—Ç–∞–≤–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. ${betAmount} –∂–µ—Ç–æ–Ω–æ–≤ —Å–ø–∏—Å–∞–Ω—ã —Å –±–∞–ª–∞–Ω—Å–∞ –∏–≥—Ä–æ–∫–∞ ${playerName}`, 'success');
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–≤–æ–∫
                await loadAllBets();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–æ–≤
                await loadPlayersData();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏: ' + error.message, 'error');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –Ω–∞–≤—Å–µ–≥–¥–∞
        async function deleteBetPermanently(betId, playerName) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞–≤–∫—É –∏–≥—Ä–æ–∫–∞ ${playerName} –Ω–∞–≤—Å–µ–≥–¥–∞? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.`)) {
                return;
            }
            
            try {
                const { error } = await db
                    .from('player_bets')
                    .delete()
                    .eq('id', betId);
                
                if (error) throw error;
                
                showNotification('–°—Ç–∞–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞ –Ω–∞–≤—Å–µ–≥–¥–∞', 'success');
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–≤–æ–∫
                await loadAllBets();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏: ' + error.message, 'error');
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function updateNavForUser() {
            const loginText = document.getElementById('loginText');
            const mobileLoginText = document.getElementById('mobileLoginText');
            
            if (currentUser) {
                if (loginText) loginText.textContent = currentUser.player_name || '–ò–≥—Ä–æ–∫';
                if (mobileLoginText) mobileLoginText.textContent = currentUser.player_name || '–ò–≥—Ä–æ–∫';
            } else {
                if (loginText) loginText.textContent = '–í–æ–π—Ç–∏';
                if (mobileLoginText) mobileLoginText.textContent = '–í–æ–π—Ç–∏';
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–≥—Ä–æ–∫–µ —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Å—Ç–∞–≤–æ–∫
        function showPlayerInfo() {
            if (!currentUser) return;
            
            const player = allPlayers.find(p => p.name === currentUser.player_name);
            const userPurchases = playerPurchases.filter(p => p.player_name === currentUser.player_name);
            const matches = player ? parseInt(player.matches) || 0 : 0;
            const wins = player ? parseInt(player.wins) || 0 : 0;
            const winRate = matches > 0 ? Math.round((wins / matches) * 100) : 0;
            
            document.getElementById('playerInfo').innerHTML = `
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    ${player && player.avatar ? 
                        `<img src="${player.avatar}" alt="${currentUser.player_name}" style="width: 100px; height: 100px; border-radius: 50%; margin: 0 auto 1rem; object-fit: cover; border: 3px solid var(--primary);">` : 
                        `<div style="width: 100px; height: 100px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; margin: 0 auto 1rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem; font-weight: bold;">
                            ${currentUser.player_name ? currentUser.player_name.charAt(0).toUpperCase() : '?'}
                        </div>`
                    }
                    <h3 style="margin-bottom: 0.5rem;">${currentUser.player_name || '–ë–µ–∑ –∏–º–µ–Ω–∏'}</h3>
                    <p style="color: var(--gray); margin-bottom: 1rem;">–õ–æ–≥–∏–Ω: ${currentUser.login}</p>
                </div>
                
                <div style="background: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 0.25rem;">–†–µ–π—Ç–∏–Ω–≥</div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">${player ? player.rating : '–ù/–î'}</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 0.25rem;">–ñ–µ—Ç–æ–Ω—ã</div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--warning);">
                                <i class="fas fa-coins"></i> ${currentUser.tokens || 0}
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 0.9rem; color: var(--gray);">–ú–∞—Ç—á–∏</div>
                            <div style="font-size: 1.2rem; font-weight: bold;">${matches}</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.9rem; color: var(--gray);">–ü–æ–±–µ–¥—ã</div>
                            <div style="font-size: 1.2rem; font-weight: bold;">${wins}</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.9rem; color: var(--gray);">–ü—Ä–æ—Ü–µ–Ω—Ç</div>
                            <div style="font-size: 1.2rem; font-weight: bold;">${winRate}%</div>
                        </div>
                    </div>
                    
                    ${userPurchases.length > 0 ? `
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e5e7eb;">
                            <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 0.5rem;">–í–∞—à–∏ –ø–æ–∫—É–ø–∫–∏ (${userPurchases.length}):</div>
                            <div style="max-height: 150px; overflow-y: auto; font-size: 0.85rem;">
                                ${userPurchases.slice(0, 5).map(purchase => `
                                    <div style="display: flex; justify-content: space-between; padding: 0.25rem 0; border-bottom: 1px solid #f0f0f0;">
                                        <span>${purchase.item_name}</span>
                                        <span style="color: var(--warning);">-${purchase.price} –∂–µ—Ç–æ–Ω–æ–≤</span>
                                    </div>
                                `).join('')}
                                ${userPurchases.length > 5 ? `
                                    <div style="text-align: center; padding: 0.5rem; color: var(--gray); font-size: 0.8rem;">
                                        ... –∏ –µ—â–µ ${userPurchases.length - 5} –ø–æ–∫—É–ø–æ–∫
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    ` : ''}
                </div>
                
                <!-- –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ -->
                <div style="background: white; border: 1px solid #e5e7eb; border-radius: 0.5rem; margin-bottom: 1.5rem; overflow: hidden;">
                    <div style="background: #f9fafb; padding: 1rem; border-bottom: 1px solid #e5e7eb;">
                        <h4 style="display: flex; justify-content: space-between; align-items: center; margin: 0;">
                            <span><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</span>
                            <button onclick="loadPlayerBets()" style="background: none; border: none; color: var(--primary); cursor: pointer;">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </h4>
                    </div>
                    <div id="playerBetsList" style="max-height: 300px; overflow-y: auto; padding: 1rem;">
                        <div class="loading" style="text-align: center; padding: 2rem;">
                            <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞–≤–æ–∫...
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem;">
                    <button onclick="logout()" class="bet-btn danger" style="flex: 1;">
                        <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                    </button>
                    <a href="#shop" onclick="closeModal('playerModal')" class="bet-btn success" style="flex: 1; text-align: center; text-decoration: none;">
                        <i class="fas fa-store"></i> –ú–∞–≥–∞–∑–∏–Ω
                    </a>
                </div>
            `;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞–≤–æ–∫
            loadPlayerBets();
            openModal('playerModal');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞–≤–æ–∫ –∏–≥—Ä–æ–∫–∞
        async function loadPlayerBets() {
            if (!currentUser) return;
            
            const betsList = document.getElementById('playerBetsList');
            if (!betsList) return;
            
            betsList.innerHTML = '<div class="loading" style="text-align: center; padding: 2rem;"><i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞–≤–æ–∫...</div>';
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞–≤–∫–∏ –∏–≥—Ä–æ–∫–∞
                const { data: bets, error } = await db
                    .from('player_bets')
                    .select('*')
                    .eq('player_name', currentUser.player_name)
                    .order('created_at', { ascending: false });
                
                if (error) {
                    // –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                    if (error.message.includes("Could not find the table") || error.code === 'PGRST205') {
                        betsList.innerHTML = `
                            <div style="text-align: center; padding: 2rem; color: var(--gray);">
                                <i class="fas fa-coins" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                <div>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞–≤–æ–∫</div>
                                <small>–ù–∞—á–Ω–∏—Ç–µ –¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫–∏ –Ω–∞ –º–∞—Ç—á–∏</small>
                            </div>
                        `;
                        return;
                    }
                    throw error;
                }
                
                if (!bets || bets.length === 0) {
                    betsList.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--gray);">
                            <i class="fas fa-coins" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <div>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞–≤–æ–∫</div>
                            <small>–ù–∞—á–Ω–∏—Ç–µ –¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫–∏ –Ω–∞ –º–∞—Ç—á–∏</small>
                        </div>
                    `;
                    return;
                }
                
                // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞—Ç—á–∞—Ö
                const matchIds = [...new Set(bets.map(bet => bet.match_id))];
                const { data: matches } = await db
                    .from('bet_matches')
                    .select('*')
                    .in('id', matchIds);
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–≤–æ–∫
                let betsHtml = '';
                let totalBets = bets.length;
                let activeBets = 0;
                let wonBets = 0;
                let lostBets = 0;
                let totalWon = 0;
                let totalStaked = 0;
                
                bets.forEach(bet => {
                    const match = matches ? matches.find(m => m.id === bet.match_id) : null;
                    const matchInfo = match ? 
                        `${match.player1} vs ${match.player2}` : 
                        `–ú–∞—Ç—á ${bet.match_id}`;
                    
                    const betAmount = parseFloat(bet.amount) || 0;
                    const potentialWin = parseFloat(bet.potential_win) || 0;
                    const actualWin = parseFloat(bet.actual_win) || 0;
                    
                    totalStaked += betAmount;
                    totalWon += actualWin;
                    
                    let statusBadge = '';
                    let statusColor = '';
                    let resultText = '';
                    
                    switch(bet.status) {
                        case 'active':
                            statusBadge = '–ê–∫—Ç–∏–≤–Ω–∞';
                            statusColor = '#f59e0b';
                            activeBets++;
                            resultText = `–í–æ–∑–º–æ–∂–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à: ${potentialWin.toFixed(2)}`;
                            break;
                        case 'won':
                            statusBadge = '–í—ã–∏–≥—Ä–∞–Ω–∞';
                            statusColor = '#10b981';
                            wonBets++;
                            resultText = `–í—ã–∏–≥—Ä–∞–Ω–æ: ${actualWin.toFixed(2)}`;
                            break;
                        case 'lost':
                            statusBadge = '–ü—Ä–æ–∏–≥—Ä–∞–Ω–∞';
                            statusColor = '#ef4444';
                            lostBets++;
                            resultText = `–ü–æ—Ç–µ—Ä—è–Ω–æ: ${betAmount.toFixed(2)}`;
                            break;
                        case 'cancelled':
                            statusBadge = '–û—Ç–º–µ–Ω–µ–Ω–∞';
                            statusColor = '#6b7280';
                            resultText = '–í–æ–∑–≤—Ä–∞—â–µ–Ω–æ';
                            break;
                        default:
                            statusBadge = '–í –æ–∂–∏–¥–∞–Ω–∏–∏';
                            statusColor = '#f97316';
                    }
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞ –∫–æ–≥–æ –±—ã–ª–∞ —Å—Ç–∞–≤–∫–∞
                    let betOnName = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                    if (match) {
                        betOnName = bet.bet_on === 'player1' ? match.player1 : 
                                   bet.bet_on === 'player2' ? match.player2 : 
                                   '–ù–∏—á—å—è';
                    }
                    
                    const betDate = new Date(bet.created_at);
                    const timeAgo = getTimeAgo(betDate);
                    
                    betsHtml += `
                        <div style="padding: 0.75rem; border-bottom: 1px solid #f0f0f0; background: white;">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem;">
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 0.95rem; margin-bottom: 0.25rem;">${matchInfo}</div>
                                    <div style="font-size: 0.85rem; color: var(--gray);">
                                        –°—Ç–∞–≤–∫–∞ –Ω–∞: <strong>${betOnName}</strong> (–∫–æ—ç—Ñ. ${parseFloat(bet.odds).toFixed(2)})
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: bold; font-size: 1rem; margin-bottom: 0.25rem; color: ${bet.status === 'won' ? 'var(--success)' : 'var(--dark)'}">
                                        ${betAmount} <i class="fas fa-coins" style="color: var(--warning);"></i>
                                    </div>
                                    <div style="font-size: 0.75rem; padding: 0.2rem 0.5rem; border-radius: 1rem; background: ${statusColor}20; color: ${statusColor};">
                                        ${statusBadge}
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem;">
                                <div style="color: var(--gray);">
                                    ${resultText}
                                </div>
                                <div style="color: var(--gray); font-size: 0.75rem;">
                                    ${timeAgo}
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç–∞–≤–æ–∫
                const winRateBets = totalBets > 0 ? Math.round((wonBets / totalBets) * 100) : 0;
                const netProfit = totalWon - totalStaked;
                
                const statsHtml = `
                    <div style="background: #f8fafc; padding: 0.75rem; border-bottom: 1px solid #e5e7eb; font-size: 0.85rem;">
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; text-align: center;">
                            <div>
                                <div style="font-weight: bold;">${totalBets}</div>
                                <div style="font-size: 0.7rem; color: var(--gray);">–í—Å–µ–≥–æ</div>
                            </div>
                            <div>
                                <div style="font-weight: bold; color: var(--success);">${wonBets}</div>
                                <div style="font-size: 0.7rem; color: var(--gray);">–í—ã–∏–≥—Ä–∞–Ω–æ</div>
                            </div>
                            <div>
                                <div style="font-weight: bold;">${winRateBets}%</div>
                                <div style="font-size: 0.7rem; color: var(--gray);">–ü—Ä–æ—Ü–µ–Ω—Ç</div>
                            </div>
                            <div>
                                <div style="font-weight: bold; color: ${netProfit >= 0 ? 'var(--success)' : 'var(--danger)'};">
                                    ${netProfit >= 0 ? '+' : ''}${netProfit.toFixed(2)}
                                </div>
                                <div style="font-size: 0.7rem; color: var(--gray);">–ü—Ä–∏–±—ã–ª—å</div>
                            </div>
                        </div>
                    </div>
                    ${betsHtml}
                `;
                
                betsList.innerHTML = statsHtml;
                
                // –ï—Å–ª–∏ —Å—Ç–∞–≤–æ–∫ –º–Ω–æ–≥–æ, –¥–æ–±–∞–≤–ª—è–µ–º —Å–∫—Ä–æ–ª–ª
                if (bets.length > 5) {
                    betsList.style.maxHeight = '300px';
                    betsList.style.overflowY = 'auto';
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–≤–æ–∫ –∏–≥—Ä–æ–∫–∞:', error);
                betsList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--danger);">
                        <i class="fas fa-exclamation-circle" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <div>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–≤–æ–∫</div>
                        <small>${error.message}</small>
                    </div>
                `;
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏
        function getTimeAgo(date) {
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 1) {
                return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
            } else if (diffMins < 60) {
                return `${diffMins} –º–∏–Ω –Ω–∞–∑–∞–¥`;
            } else if (diffHours < 24) {
                return `${diffHours} —á –Ω–∞–∑–∞–¥`;
            } else if (diffDays < 7) {
                return `${diffDays} –¥ –Ω–∞–∑–∞–¥`;
            } else {
                return date.toLocaleDateString('ru-RU');
            }
        }

        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'info');
            closeModal('playerModal');
            updateNavForUser();
            loadLiveMatches();
            loadShop();
        }

        // –†–∞–∑–º–µ—â–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
        async function placeBet(matchId) {
            if (!currentUser) {
                showNotification('–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É', 'error');
                return;
            }
            
            const match = allMatches.find(m => m.id === matchId);
            if (!match || match.status !== 'live') {
                showNotification('–ú–∞—Ç—á –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω –¥–ª—è —Å—Ç–∞–≤–æ–∫', 'error');
                return;
            }
            
            if (!selectedBets[matchId]) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –¥–ª—è —Å—Ç–∞–≤–∫–∏', 'error');
                return;
            }
            
            const input = document.getElementById(`bet-amount-${matchId}`);
            if (!input) return;
            
            const amount = parseInt(input.value);
            const maxBet = Math.floor((currentUser.tokens || 0) * 0.5);
            
            if (!amount || amount < 1) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏', 'error');
                return;
            }
            
            if (amount > maxBet) {
                showNotification(`–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${maxBet} –∂–µ—Ç–æ–Ω–æ–≤`, 'error');
                return;
            }
            
            if (amount > (currentUser.tokens || 0)) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤', 'error');
                return;
            }
            
            try {
                const betData = selectedBets[matchId];
                const odds = betData.odds;
                const potentialWin = Math.round(amount * odds * 100) / 100;
                
                // –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –æ —Å—Ç–∞–≤–∫–µ
                const betId = 'bet_' + Date.now().toString(36);
                
                const { error: betError } = await db
                    .from('player_bets')
                    .insert([{
                        id: betId,
                        match_id: matchId,
                        player_name: currentUser.player_name,
                        bet_on: betData.betOn,
                        amount: amount,
                        odds: odds,
                        potential_win: potentialWin,
                        status: 'active',
                        created_at: new Date().toISOString()
                    }]);
                
                if (betError) {
                    // –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ–º —Å—Ç–∞–≤–∫—É –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –±–∞–∑—É
                    if (betError.message.includes("Could not find the table")) {
                        showNotification(`–°—Ç–∞–≤–∫–∞ ${amount} –∂–µ—Ç–æ–Ω–æ–≤ –Ω–∞ ${betData.playerName} –ø—Ä–∏–Ω—è—Ç–∞! (—Ç–∞–±–ª–∏—Ü–∞ —Å—Ç–∞–≤–æ–∫ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞)`, 'success');
                    } else {
                        throw betError;
                    }
                } else {
                    showNotification(`–°—Ç–∞–≤–∫–∞ ${amount} –∂–µ—Ç–æ–Ω–æ–≤ –Ω–∞ ${betData.playerName} –ø—Ä–∏–Ω—è—Ç–∞! –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à: ${potentialWin.toFixed(2)}`, 'success');
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞
                const newTokens = (currentUser.tokens || 0) - amount;
                
                const { error: updateError } = await db
                    .from('player_cabinets')
                    .update({ tokens: newTokens })
                    .eq('id', currentUser.id);
                
                if (updateError) throw updateError;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                currentUser.tokens = newTokens;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                input.value = '';
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
                delete selectedBets[matchId];
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±–æ—Ä–µ
                const betInfo = document.getElementById(`bet-info-${matchId}`);
                if (betInfo) {
                    betInfo.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞';
                }
                
                // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–æ–∫
                const matchCard = input.closest('.match-card');
                if (matchCard) {
                    const oddsBtns = matchCard.querySelectorAll('.odds-btn');
                    oddsBtns.forEach(btn => btn.classList.remove('selected'));
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                await updateStats();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–æ–≤
                await loadPlayersData();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
                loadShop();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞–≤–æ–∫ –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç –ø—Ä–æ—Ñ–∏–ª—å
                if (document.getElementById('playerModal').style.display === 'block') {
                    setTimeout(() => loadPlayerBets(), 500);
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏: ' + error.message, 'error');
            }
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å HTML
        function showNotificationWithHtml(html, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = html;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è
            const closeBtn = document.createElement('button');
            closeBtn.innerHTML = '&times;';
            closeBtn.style.cssText = 'position: absolute; top: 5px; right: 10px; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;';
            closeBtn.onclick = function() {
                notification.remove();
            };
            
            notification.style.position = 'relative';
            notification.appendChild(closeBtn);
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 10000);
        }
    </script>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</body>
</html>
